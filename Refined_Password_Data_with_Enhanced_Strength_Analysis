import pandas as pd
import re

# Function to evaluate password strength
def evaluate_password_strength_precise(password):
    """
    Categorize password strength as Weak, Medium, or Strong based on:
    - Weak: Less than 8 characters.
    - Medium: Contains letters and numbers but lacks special characters or uppercase.
    - Strong: Contains uppercase, lowercase, numbers, and special characters.
    """
    if len(password) < 8:
        return "Weak"
    elif re.search(r"[A-Z]", password) and re.search(r"[a-z]", password) and re.search(r"[0-9]", password) and re.search(r"[!@#$%^&*(),.?\":{}|<>]", password):
        return "Strong"
    elif re.search(r"[A-Za-z]", password) and re.search(r"[0-9]", password):
        return "Medium"
    else:
        return "Weak"

# Load the dataset
file_path = 'top_200_password_2020_by_country_updated.csv'  # Replace with your file path
data = pd.read_csv(file_path)

# Add the new column for password strength
data['Password_Strength'] = data['Password'].apply(evaluate_password_strength_precise)

# Save the updated dataset to a new CSV file
output_file_path = 'updated_password_data_with_strength.csv'
data.to_csv(output_file_path, index=False)

# Print success message
print(f"Updated file saved as: {output_file_path}")
